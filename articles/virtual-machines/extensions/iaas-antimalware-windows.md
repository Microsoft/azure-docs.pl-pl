---
title: Rozszerzenie chroniące przed złośliwym oprogramowaniem firmy Microsoft dla maszyn wirtualnych z systemem Windows
description: Wdróż rozszerzenie Azure chroniące przed złośliwym kodem na maszynie wirtualnej z systemem Windows przy użyciu rozszerzenia.
services: virtual-machines
documentationcenter: ''
author: TerryLanfear
manager: rkarlin
editor: ''
ms.assetid: ''
ms.service: virtual-machines
ms.subservice: extensions
ms.collection: windows
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure-services
ms.date: 02/23/2021
ms.author: terrylan
ms.openlocfilehash: 0ed5d7b1367d40fa5769fc26acfdddf941fea4cc
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/19/2021
ms.locfileid: "104596352"
---
# <a name="microsoft-antimalware-extension-for-windows"></a>Rozszerzenie chroniące przed złośliwym oprogramowaniem firmy Microsoft dla systemu Windows

## <a name="overview"></a>Omówienie

Nowoczesne zagrożenie w środowiskach chmury jest niezwykle dynamiczne, zwiększając nacisk na subskrybentów chmury IT dla firm, aby zachować skuteczną ochronę w celu spełnienia wymagań dotyczących zgodności i zabezpieczeń. Ochrona przed złośliwym oprogramowaniem firmy Microsoft dla systemu Azure to bezpłatna funkcja ochrony w czasie rzeczywistym, która pomaga identyfikować i usuwać wirusy, programy szpiegujące oraz inne złośliwe oprogramowanie, z konfigurowalnymi alertami, gdy znane złośliwe lub niechciane oprogramowanie próbuje zainstalować się lub uruchomić w systemach platformy Azure. Rozwiązanie jest oparte na tej samej platformie chroniącej przed złośliwym kodem co Microsoft Security Essentials (MSE), Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune i Windows Defender dla systemu Windows 8,0 lub nowszego.
Oprogramowanie chroniące przed złośliwym oprogramowaniem firmy Microsoft dla systemu Azure to rozwiązanie o pojedynczym agencie dla aplikacji i środowisk dzierżawców, przeznaczone do uruchamiania w tle bez interwencji człowieka. Ochronę można wdrożyć na podstawie potrzeb obciążeń aplikacji z podstawową, bezpieczną lub zaawansowaną konfiguracją niestandardową, w tym z monitorowaniem złośliwego oprogramowania.

## <a name="prerequisites"></a>Wymagania wstępne

### <a name="operating-system"></a>System operacyjny

Rozwiązanie Microsoft chroniące przed złośliwym kodem dla platformy Azure obejmuje klienta programu Microsoft chroniącego przed złośliwym kodem, a także klasycznego modelu wdrażania oprogramowania chroniącego przed złośliwym kodem, poleceń cmdlet programu PowerShell i rozszerzenia Diagnostyka Azure. Rozwiązanie Microsoft chroniące przed złośliwym kodem jest obsługiwane w systemach operacyjnych Windows Server 2008 R2, Windows Server 2012 i Windows Server 2012 R2. Nie jest on obsługiwany w systemie operacyjnym Windows Server 2008, a także nie jest obsługiwany przez system Linux. 

Usługa Windows Defender jest wbudowanym oprogramowaniem chroniącym przed złośliwym kodem w systemie Windows Server 2016. Interfejs Windows Defender jest również domyślnie włączony w przypadku niektórych jednostek SKU systemu Windows Server 2016.
Rozszerzenie Azure VM do ochrony przed złośliwym kodem można nadal dodać do maszyny wirtualnej platformy Azure z systemem Windows Server 2016 i usługi Windows Defender, ale w tym scenariuszu rozszerzenie będzie stosowało wszystkie opcjonalne zasady konfiguracji, które będą używane przez usługę Windows Defender, rozszerzenie nie będzie wdrażać żadnej dodatkowej usłudze ochrony przed złośliwym kodem. Więcej informacji na temat tej aktualizacji można znaleźć [tutaj](/archive/blogs/azuresecurity/update-to-azure-antimalware-extension-for-cloud-services).

### <a name="internet-connectivity"></a>Łączność z Internetem

Oprogramowanie chroniące przed złośliwym oprogramowaniem firmy Microsoft dla systemu Windows wymaga, aby docelowa maszyna wirtualna była połączona z Internetem w celu otrzymywania regularnych aktualizacji aparatu i sygnatur. 

## <a name="template-deployment"></a>Wdrażanie na podstawie szablonu
Rozszerzenia maszyny wirtualnej platformy Azure można wdrażać za pomocą szablonów Azure Resource Manager. Szablony są idealne do wdrożenia co najmniej jednej maszyny wirtualnej, która wymaga konfiguracji po wdrożeniu, na przykład do dołączania do usługi Azure chroniącej przed złośliwym kodem.

Konfiguracja JSON rozszerzenia maszyny wirtualnej może być zagnieżdżona w ramach zasobu maszyny wirtualnej lub umieszczona na głównym lub najwyższego poziomu szablonu JSON Menedżer zasobów. Położenie konfiguracji JSON wpływa na wartość nazwy i typu zasobu. Aby uzyskać więcej informacji, zobacz [Ustawianie nazwy i typu dla zasobów podrzędnych](../../azure-resource-manager/templates/child-resource-name-type.md). 

W poniższym przykładzie przyjęto założenie, że rozszerzenie maszyny wirtualnej jest zagnieżdżone w zasobie maszyn wirtualnych. Podczas zagnieżdżania zasobu rozszerzenia kod JSON jest umieszczany w `"resources": []` obiekcie maszyny wirtualnej.

```json
{
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(parameters('vmName'),'/', parameters('vmExtensionName'))]",
      "apiVersion": "2019-07-01",
      "location": "[resourceGroup().location]",
      "dependsOn": [
        "[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))]"
      ],

      "properties": {
        "publisher": "Microsoft.Azure.Security",
        "type": "IaaSAntimalware",
        "typeHandlerVersion": "1.3",
        "autoUpgradeMinorVersion": true,
        "settings": {
          "AntimalwareEnabled": "true",
          "Exclusions": {
            "Extensions": ".log;.ldf",
            "Paths": "D:\\IISlogs;D:\\DatabaseLogs",
            "Processes": "mssence.svc"
          },

          "RealtimeProtectionEnabled": "true",
          "ScheduledScanSettings": {
            "isEnabled": "true",
            "scanType": "Quick",
            "day": "7",
            "time": "120"
          }
        },
        "protectedSettings": null
      }
}
```

## <a name="powershell-deployment"></a>Wdrażanie przy użyciu programu PowerShell
Zależy od typu wdrożenia, użyj odpowiednich poleceń, aby wdrożyć rozszerzenie maszyny wirtualnej Azure chroniące przed złośliwym kodem na istniejącej maszynie wirtualnej.

  * [Maszyna wirtualna na Azure Resource Manager](../../security/fundamentals/antimalware-code-samples.md#enable-and-configure-microsoft-antimalware-for-azure-resource-manager-vms)
  * [Klastry usługi Azure Service Fabric](../../security/fundamentals/antimalware-code-samples.md#add-microsoft-antimalware-to-azure-service-fabric-clusters)
  * [Klasyczna usługa w chmurze](/powershell/module/servicemanagement/azure.service/set-azureserviceextension)

## <a name="troubleshoot-and-support"></a>Rozwiązywanie problemów i pomoc techniczna

### <a name="troubleshoot"></a>Rozwiązywanie problemów

Dzienniki rozszerzeń programu Microsoft chroniące przed złośliwym kodem są dostępne pod adresem%Systemdrive%\WindowsAzure\Logs\Plugins\Microsoft.Azure.Security.IaaSAntimalware (lub PaaSAntimalware) \1.5.5.x (wersja #) \CommandExecution.log

### <a name="error-codes-and-their-meanings"></a>Kody błędów i ich znaczenie

| Kod błędu | Znaczenie | Możliwa akcja |
| :---: | --- | --- |
| -2147156224 | Plik MSI jest zajęty przy użyciu innej instalacji | Spróbuj uruchomić instalację |
| -2147156221 | Instalator programu MSE jest już uruchomiony | Uruchamiaj tylko jedno wystąpienie naraz |
| -2147156208 | Mało miejsca na dysku < 200 MB | Usuń nieużywane pliki i ponów próbę instalacji |
| -2147156187 | Ostatnia instalacja, uaktualnianie, aktualizowanie lub odinstalowywanie zażądano ponownego uruchomienia | Uruchom ponownie i ponów próbę instalacji |
| -2147156121 | Instalator próbował usunąć produkt konkurenta. Ale nie można odinstalować produktu konkurencji | Spróbuj ręcznie usunąć produkt konkurenta, uruchom ponownie komputer i ponów próbę instalacji  |
| -2147156116 | Sprawdzanie poprawności pliku zasad nie powiodło się | Upewnij się, że do konfiguracji przeszedł prawidłowy plik XML zasad  |
| -2147156095 | Instalator nie może uruchomić usługi ochrony przed złośliwym kodem | Sprawdź, czy wszystkie pliki binarne są prawidłowo podpisane i czy jest zainstalowany prawidłowy plik licencjonowania |
| -2147023293 | Podczas instalacji wystąpił błąd krytyczny. W większości przypadków będzie to możliwe. Epp.msi — nie można register\start\stop usługi AM ani sterownika Miniego filtru | Dzienniki MSI z EPP.msi są w tym miejscu wymagane do przyszłego zbadania |
| -2147023277 | Nie można otworzyć pakietu instalacyjnego | Sprawdź, czy pakiet istnieje i czy jest dostępny, lub skontaktuj się z dostawcą aplikacji, aby upewnić się, że jest to prawidłowy pakiet Instalator Windows |
| -2147156109 | Usługa Defender jest wymagana jako warunek wstępny |  |
| -2147205073 | Wystawca WebSSO nie jest obsługiwany | |
| -2147024893 | System nie może odnaleźć określonej ścieżki |  |
| -2146885619 | Nie jest to komunikat kryptograficzny lub komunikat kryptograficzny nie jest poprawnie sformatowany |  |
| -1073741819 | Instrukcja w 0x% p odwołuje się do pamięci w 0x% p. Pamięć nie może być% s |  |
| 1 | Niepoprawna funkcja |  |


### <a name="support"></a>Pomoc techniczna

Jeśli potrzebujesz więcej pomocy w dowolnym punkcie tego artykułu, możesz skontaktować się z ekspertami platformy Azure na [forach MSDN i Stack Overflow](https://azure.microsoft.com/support/forums/). Alternatywnie możesz zaplikować zdarzenie pomocy technicznej platformy Azure. Przejdź do [witryny pomocy technicznej systemu Azure](https://azure.microsoft.com/support/options/)i wybierz pozycję Uzyskaj pomoc techniczną. Aby uzyskać informacje o korzystaniu z pomocy technicznej platformy Azure, przeczytaj temat [Microsoft Azure support — często zadawane pytania](https://azure.microsoft.com/support/faq/).
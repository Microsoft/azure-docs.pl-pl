---
title: Przechowaj wyniki skanowania oceny luk w zabezpieczeniach na koncie magazynu dostępnym za zaporami i sieci wirtualnych
description: Zawiera instrukcje dotyczące sposobu przechowywania skanów oceny luk w zabezpieczeniach (VA) na koncie magazynu, do którego można uzyskać dostęp za pomocą zapory lub sieci wirtualnej
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.topic: how-to
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 12/01/2020
ms.openlocfilehash: 83dbc04eb412d1e42fa8b42a3324c31a55db8adb
ms.sourcegitcommit: aacbf77e4e40266e497b6073679642d97d110cda
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/12/2021
ms.locfileid: "98116753"
---
# <a name="store-vulnerability-assessment-scan-results-in-a-storage-account-accessible-behind-firewalls-and-vnets"></a>Przechowaj wyniki skanowania oceny luk w zabezpieczeniach na koncie magazynu dostępnym za zaporami i sieci wirtualnych
[!INCLUDE[appliesto-sqldb-sqlmi](../includes/appliesto-sqldb-sqlmi.md)]

Jeśli ograniczasz dostęp do konta magazynu na platformie Azure dla określonych sieci wirtualnych lub usług, musisz włączyć odpowiednią konfigurację, aby przeprowadzenie oceny luk w zabezpieczeniach (VA) dla baz danych SQL lub wystąpień zarządzanych miało dostęp do tego konta magazynu.

## <a name="enable-azure-sql-database-va-scanning-access-to-the-storage-account"></a>Włącz dostęp do skanowania w Azure SQL Database VA do konta magazynu

Jeśli konto magazynu VA zostało skonfigurowane tak, aby były dostępne tylko dla niektórych sieci lub usług, musisz się upewnić, że skanowanie w celu przeskanowania w Azure SQL Database będzie możliwe do przechowywania skanów na koncie magazynu. Możesz użyć istniejącego konta magazynu lub utworzyć nowe konto magazynu do przechowywania wyników skanowania VA dla wszystkich baz danych na [serwerze logicznym programu SQL Server](logical-servers.md).

> [!NOTE]
> Usługa oceny luk w zabezpieczeniach nie może uzyskać dostępu do kont magazynu chronionych przez zapory lub sieci wirtualnych, jeśli wymagają kluczy dostępu do magazynu.

Przejdź do **grupy zasobów** zawierającej konto magazynu i uzyskaj dostęp do okienka **konto magazynu** . W obszarze **Ustawienia** wybierz pozycję **Zapora i sieci wirtualne**.

Upewnij się, że jest zaznaczone pole wyboru **Zezwalaj na dostęp do tego konta dla zaufanych usług firmy Microsoft** .

:::image type="content" source="media/sql-database-vulnerability-assessment-storage/storage-allow-microsoft-services.png" alt-text="Zrzut ekranu przedstawia okno dialogowe Zapora i sieci wirtualne z opcją Zezwalaj zaufanym usługom firmy Microsoft na dostęp do wybranego konta magazynu.":::

Aby dowiedzieć się, które konto magazynu jest używane, przejdź do okienka **programu SQL Server** w [Azure Portal](https://portal.azure.com)w obszarze **zabezpieczenia** wybierz pozycję **Security Center**.

:::image type="content" source="../database/media/azure-defender-for-sql/va-storage.png" alt-text="Konfigurowanie oceny luk w zabezpieczeniach":::

## <a name="store-va-scan-results-for-azure-sql-managed-instance-in-a-storage-account-that-can-be-accessed-behind-a-firewall-or-vnet"></a>Przechowaj wyniki skanowania VA dla wystąpienia zarządzanego usługi Azure SQL na koncie magazynu, do którego można uzyskać dostęp za zaporą lub siecią wirtualną

Ponieważ wystąpienie zarządzane nie jest zaufaną usługą firmy Microsoft i ma inną sieć wirtualną z konta magazynu, wykonanie skanowania przy użyciu protokołu VA spowoduje wystąpienie błędu.

Aby obsłużyć skanowanie VA w wystąpieniach zarządzanych, wykonaj następujące czynności:

1. W okienku **wystąpienie zarządzane SQL** w obszarze nagłówek **omówienia** kliknij link **Sieć wirtualna/podsieć** . Spowoduje to przejście do okienka **Sieć wirtualna** .

   :::image type="content" source="../managed-instance/media/public-endpoint-configure/mi-overview.png" alt-text="mi — overview2":::

1. W obszarze **Ustawienia** wybierz pozycję **Podsieci**. Kliknij pozycję **podsieć** w nowym okienku, aby dodać podsieć i delegować ją do *Microsoft. sql\managedInstance*. Aby uzyskać więcej informacji, zobacz [Zarządzanie podsieciami](../../virtual-network/virtual-network-manage-subnet.md).

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/mi-subnets.png" alt-text="Zrzut ekranu przedstawia podsieć, która ma delegowane dane Microsoft. sql\managedInstance.":::

1. W okienku **Sieć wirtualna** w obszarze **Ustawienia** wybierz pozycję **punkty końcowe usługi**. Kliknij przycisk **Dodaj** w nowym okienku i Dodaj usługę *Microsoft. Storage* jako nowy punkt końcowy usługi. Upewnij się, że wybrano podsieć *ManagedInstance* . Kliknij pozycję **Dodaj**.

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/mi-service-endpoint.png" alt-text="Zrzut ekranu przedstawia Dodawanie punktów końcowych usługi, do których dodawana jest usługa Microsoft. Storage jako punkt końcowy.":::

1. Przejdź do swojego **konta magazynu** , które zostało wybrane do przechowywania skanów. W obszarze **Ustawienia** wybierz pozycję **Zapora i sieci wirtualne**. Kliknij pozycję **Dodaj istniejącą sieć wirtualną**. Wybierz sieć wirtualną wystąpienia zarządzanego i podsieć, a następnie kliknij przycisk **Dodaj**.

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/storage-firewall.png" alt-text="Zrzut ekranu przedstawia okienko zapory i sieci wirtualne, które zawiera łącze Dodaj istniejące sieci wirtualne.":::

Teraz powinno być możliwe przechowywanie skanów VA dla wystąpień zarządzanych na koncie magazynu.

## <a name="next-steps"></a>Następne kroki

- [Ocena luk w zabezpieczeniach](sql-vulnerability-assessment.md)
- [Tworzenie konta usługi Azure Storage](../../storage/common/storage-account-create.md)
- [Usługa Azure Defender dla bazy danych SQL](azure-defender-for-sql.md)
